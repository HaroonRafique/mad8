      subroutine ladr2c(nord, g, f)
      implicit none
*----------------------------------------------------------------------*
* Purpose:                                                             *
*   Transform from a dynamic resonance basis to a Cartesian basis.     *
* Source:     MARYLIE, version 3.0 (routine DRTOC).                    *
* Author:     Filippo Neri, June 1986.                                 *
* Input:                                                               *
*   NORD      (integer) Order of the map G (at most 4).                *
*   G(*)      Dynamic resonance basis coefficients.                    *
* Output:                                                              *
*   F(*)      Cartesian basis coefficients.                            *
*----------------------------------------------------------------------*
      integer mcfil,mcnam,mcrng,mcstr,mcwrd,mreal,mwflt,mwnam,
     +mbbparam
*---- Double precision version.
      parameter         (mwflt = 2, mcwrd = 4, mreal = 4)
      parameter         (mcnam = 16, mwnam = mcnam / mcwrd)
      parameter         (mcfil = 80, mcrng = 40, mcstr = 512)
      parameter         (mbbparam = 26)
      integer mttact
      parameter (mttact = 100)
      integer nord
      double precision f,g
      dimension         f(*), g(*)
 
      f(1) = g(1)
      f(2) = g(2)
      f(3) = g(3)
      f(4) = g(4)
      f(5) = g(5)
      f(6) = g(6)
      if (nord .ge. 2) then
        f(7) = g(20)+g(7)
        f(8) = 2.0*g(21)
        f(9) = g(26)+g(24)
        f(10) = -g(27)+g(25)
        f(11) = g(14)+g(12)
        f(12) = -g(15)+g(13)
        f(13) = -g(20)+g(7)
        f(14) = g(27)+g(25)
        f(15) = g(26)-g(24)
        f(16) = g(15)+g(13)
        f(17) = g(14)-g(12)
        f(18) = g(22)+g(8)
        f(19) = 2.0*g(23)
        f(20) = g(18)+g(16)
        f(21) = -g(19)+g(17)
        f(22) = -g(22)+g(8)
        f(23) = g(19)+g(17)
        f(24) = g(18)-g(16)
        f(25) = g(10)+g(9)
        f(26) = 2.0*g(11)
        f(27) = -g(10)+g(9)
        if (nord .ge. 3) then
          f(28) = g(72)+g(64)
          f(29) = 3.0*g(73)+g(65)
          f(30) = g(80)+g(76)+g(70)
          f(31) = -g(81)+g(77)+g(71)
          f(32) = g(50)+g(48)+g(28)
          f(33) = -g(51)+g(49)+g(29)
          f(34) = -3.0*g(72)+g(64)
          f(35) = 2.0*(g(81)+g(77))
          f(36) = 2.0*(g(80)-g(76))
          f(37) = 2.0*(g(51)+g(49))
          f(38) = 2.0*(g(50)-g(48))
          f(39) = g(82)+g(78)+g(68)
          f(40) = 2.0*(-g(83)+g(79))
          f(41) = g(62)+g(60)+g(58)+g(56)
          f(42) = -g(63)+g(61)-g(59)+g(57)
          f(43) = -g(82)-g(78)+g(68)
          f(44) = -g(63)-g(61)+g(59)+g(57)
          f(45) = -g(62)+g(60)+g(58)-g(56)
          f(46) = g(42)+g(40)+g(36)
          f(47) = 2.0*(-g(43)+g(41))
          f(48) = -g(42)-g(40)+g(36)
          f(49) = -g(73)+g(65)
          f(50) = -g(80)-g(76)+g(70)
          f(51) = g(81)-g(77)+g(71)
          f(52) = -g(50)-g(48)+g(28)
          f(53) = g(51)-g(49)+g(29)
          f(54) = g(83)+g(79)+g(69)
          f(55) = 2.0*(g(82)-g(78))
          f(56) = g(63)+g(61)+g(59)+g(57)
          f(57) = g(62)-g(60)+g(58)-g(56)
          f(58) = -g(83)-g(79)+g(69)
          f(59) = g(62)+g(60)-g(58)-g(56)
          f(60) = -g(63)+g(61)+g(59)-g(57)
          f(61) = g(43)+g(41)+g(37)
          f(62) = 2.0*(g(42)-g(40))
          f(63) = -g(43)-g(41)+g(37)
          f(64) = g(74)+g(66)
          f(65) = 3.0*g(75)+g(67)
          f(66) = g(54)+g(52)+g(30)
          f(67) = -g(55)+g(53)+g(31)
          f(68) = -3.0*g(74)+g(66)
          f(69) = 2.0*(g(55)+g(53))
          f(70) = 2.0*(g(54)-g(52))
          f(71) = g(46)+g(44)+g(38)
          f(72) = 2.0*(-g(47)+g(45))
          f(73) = -g(46)-g(44)+g(38)
          f(74) = -g(75)+g(67)
          f(75) = -g(54)-g(52)+g(30)
          f(76) = g(55)-g(53)+g(31)
          f(77) = g(47)+g(45)+g(39)
          f(78) = 2.0*(g(46)-g(44))
          f(79) = -g(47)-g(45)+g(39)
          f(80) = g(34)+g(32)
          f(81) = 3.0*g(33)+g(35)
          f(82) = -3.0*g(32)+g(34)
          f(83) = g(35)-g(33)
          if (nord .ge. 4) then
            f(84) = g(194)+g(178)+g(84)
            f(85) = 2.0*g(179)+4.0*g(195)
            f(86) = g(202)+g(198)+g(190)+g(186)
            f(87) = -g(203)+g(199)-g(191)+g(187)
            f(88) = g(156)+g(154)+g(140)+g(138)
            f(89) = -g(157)+g(155)-g(141)+g(139)
            f(90) = 2.0*g(84)-6.0*g(194)
            f(91) = 3.0*(g(203)+g(199))+g(191)+g(187)
            f(92) = 3.0*(g(202)-g(198))+g(190)-g(186)
            f(93) = 3.0*(g(157)+g(155))+g(141)+g(139)
            f(94) = 3.0*(g(156)-g(154))+g(140)-g(138)
            f(95) = g(208)+g(206)+g(184)+g(182)+g(87)
            f(96) = 2.0*(-g(209)+g(207)+g(185))
            f(97) = g(172)+g(170)+g(164)+g(162)+g(152)+g(150)
            f(98) = -g(173)+g(171)-g(165)+g(163)-g(153)+g(151)
            f(99) = -g(208)-g(206)-g(184)+g(182)+g(87)
            f(100) = -g(173)-g(171)+g(165)+g(163)+g(153)+g(151)
            f(101) = -g(172)+g(170)+g(164)-g(162)+g(152)-g(150)
            f(102) = g(120)+g(118)+g(114)+g(90)+g(88)
            f(103) = 2.0*(-g(121)+g(119)+g(91))
            f(104) = -g(120)-g(118)+g(114)-g(90)+g(88)
            f(105) = 2.0*g(179)-4.0*g(195)
            f(106) = -3.0*(g(202)+g(198))+g(190)+g(186)
            f(107) = 3.0*(g(203)-g(199))-g(191)+g(187)
            f(108) = -3.0*(g(156)+g(154))+g(140)+g(138)
            f(109) = 3.0*(g(157)-g(155))-g(141)+g(139)
            f(110) = 2.0*(g(209)+g(207)+g(183))
            f(111) = 4.0*(g(208)-g(206))
            f(112) = 2.0*(g(173)+g(171)+g(165)+g(163))
            f(113) = 2.0*(g(172)-g(170)+g(164)-g(162))
            f(114) = 2.0*(-g(209)-g(207)+g(183))
            f(115) = 2.0*(g(172)+g(170)-g(164)-g(162))
            f(116) = 2.0*(-g(173)+g(171)+g(165)-g(163))
            f(117) = 2.0*(g(121)+g(119)+g(115))
            f(118) = 4.0*(g(120)-g(118))
            f(119) = 2.0*(-g(121)-g(119)+g(115))
            f(120) = g(204)+g(200)+g(192)+g(188)
            f(121) = 3.0*(-g(205)+g(201))-g(193)+g(189)
            f(122) = g(176)+g(174)+g(168)+g(166)+g(148)+g(146)
            f(123) = g(177)-g(175)-g(169)+g(167)-g(149)+g(147)
            f(124) = -3.0*(g(204)+g(200))+g(192)+g(188)
            f(125) = 2.0*(-g(177)-g(175)+g(169)+g(167))
            f(126) = 2.0*(g(176)-g(174)+g(168)-g(166))
            f(127) = g(136)+g(134)+g(132)+g(130)+g(128)+g(126)
            f(128) = 2.0*(-g(137)+g(135)-g(133)+g(131))
            f(129) = -g(136)-g(134)-g(132)-g(130)+g(128)+g(126)
            f(130) = g(205)-g(201)-g(193)+g(189)
            f(131) = -g(176)-g(174)-g(168)-g(166)+g(148)+g(146)
            f(132) = -g(177)+g(175)+g(169)-g(167)-g(149)+g(147)
            f(133) = -g(137)-g(135)+g(133)+g(131)-g(129)+g(127)
            f(134) = 2.0*(-g(136)+g(134)+g(132)-g(130))
            f(135) = g(137)+g(135)-g(133)-g(131)-g(129)+g(127)
            f(136) = g(108)+g(106)+g(100)+g(98)
            f(137) = 3.0*(-g(101)+g(99))-g(109)+g(107)
            f(138) = -3.0*(g(100)+g(98))+g(108)+g(106)
            f(139) = -g(109)+g(107)+g(101)-g(99)
            f(140) = g(194)-g(178)+g(84)
            f(141) = -g(203)-g(199)+g(191)+g(187)
            f(142) = -g(202)+g(198)+g(190)-g(186)
            f(143) = -g(157)-g(155)+g(141)+g(139)
            f(144) = -g(156)+g(154)+g(140)-g(138)
            f(145) = -g(208)-g(206)+g(184)-g(182)+g(87)
            f(146) = 2.0*(g(209)-g(207)+g(185))
            f(147) = -g(172)-g(170)-g(164)-g(162)+g(152)+g(150)
            f(148) = g(173)-g(171)+g(165)-g(163)-g(153)+g(151)
            f(149) = g(208)+g(206)-g(184)-g(182)+g(87)
            f(150) = g(173)+g(171)-g(165)-g(163)+g(153)+g(151)
            f(151) = g(172)-g(170)-g(164)+g(162)+g(152)-g(150)
            f(152) = -g(120)-g(118)-g(114)+g(90)+g(88)
            f(153) = 2.0*(g(121)-g(119)+g(91))
            f(154) = g(120)+g(118)-g(114)-g(90)+g(88)
            f(155) = g(205)+g(201)+g(193)+g(189)
            f(156) = 3.0*(g(204)-g(200))+g(192)-g(188)
            f(157) = g(177)+g(175)+g(169)+g(167)+g(149)+g(147)
            f(158) = -g(176)+g(174)+g(168)-g(166)+g(148)-g(146)
            f(159) = -3.0*(g(205)+g(201))+g(193)+g(189)
            f(160) = 2.0*(g(176)+g(174)-g(168)-g(166))
            f(161) = 2.0*(g(177)-g(175)+g(169)-g(167))
            f(162) = g(137)+g(135)+g(133)+g(131)+g(129)+g(127)
            f(163) = 2.0*(g(136)-g(134)+g(132)-g(130))
            f(164) = -g(137)-g(135)-g(133)-g(131)+g(129)+g(127)
            f(165) = -g(204)+g(200)+g(192)-g(188)
            f(166) = -g(177)-g(175)-g(169)-g(167)+g(149)+g(147)
            f(167) = g(176)-g(174)-g(168)+g(166)+g(148)-g(146)
            f(168) = g(136)+g(134)-g(132)-g(130)+g(128)-g(126)
            f(169) = 2.0*(-g(137)+g(135)+g(133)-g(131))
            f(170) = -g(136)-g(134)+g(132)+g(130)+g(128)-g(126)
            f(171) = g(109)+g(107)+g(101)+g(99)
            f(172) = 3.0*(g(100)-g(98))+g(108)-g(106)
            f(173) = -3.0*(g(101)+g(99))+g(109)+g(107)
            f(174) = g(108)-g(106)-g(100)+g(98)
            f(175) = g(196)+g(180)+g(85)
            f(176) = 2.0*g(181)+4.0*g(197)
            f(177) = g(160)+g(158)+g(144)+g(142)
            f(178) = -g(161)+g(159)-g(145)+g(143)
            f(179) = 2.0*g(85)-6.0*g(196)
            f(180) = 3.0*(g(161)+g(159))+g(145)+g(143)
            f(181) = 3.0*(g(160)-g(158))+g(144)-g(142)
            f(182) = g(124)+g(122)+g(116)+g(92)+g(89)
            f(183) = 2.0*(-g(125)+g(123)+g(93))
            f(184) = -g(124)-g(122)+g(116)-g(92)+g(89)
            f(185) = 2.0*g(181)-4.0*g(197)
            f(186) = -3.0*(g(160)+g(158))+g(144)+g(142)
            f(187) = 3.0*(g(161)-g(159))-g(145)+g(143)
            f(188) = 2.0*(g(125)+g(123)+g(117))
            f(189) = 4.0*(g(124)-g(122))
            f(190) = 2.0*(-g(125)-g(123)+g(117))
            f(191) = g(112)+g(110)+g(104)+g(102)
            f(192) = 3.0*(-g(105)+g(103))-g(113)+g(111)
            f(193) = -3.0*(g(104)+g(102))+g(112)+g(110)
            f(194) = -g(113)+g(111)+g(105)-g(103)
            f(195) = g(196)-g(180)+g(85)
            f(196) = -g(161)-g(159)+g(145)+g(143)
            f(197) = -g(160)+g(158)+g(144)-g(142)
            f(198) = -g(124)-g(122)-g(116)+g(92)+g(89)
            f(199) = 2.0*(g(125)-g(123)+g(93))
            f(200) = g(124)+g(122)-g(116)-g(92)+g(89)
            f(201) = g(113)+g(111)+g(105)+g(103)
            f(202) = 3.0*(g(104)-g(102))+g(112)-g(110)
            f(203) = -3.0*(g(105)+g(103))+g(113)+g(111)
            f(204) = g(112)-g(110)-g(104)+g(102)
            f(205) = g(96)+g(94)+g(86)
            f(206) = 2.0*g(97)+4.0*g(95)
            f(207) = 2.0*g(86)-6.0*g(94)
            f(208) = 2.0*g(97)-4.0*g(95)
            f(209) = -g(96)+g(94)+g(86)
          endif
        endif
      endif
 
      end
