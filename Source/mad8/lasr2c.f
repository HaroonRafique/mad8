      subroutine lasr2c(nord, g, f)
      implicit none
*----------------------------------------------------------------------*
* Purpose:                                                             *
*   Transform from a static resonance basis to a Cartesian basis.      *
* Source:     MARYLIE, version 3.0 (routine SRTOC).                    *
* Input:                                                               *
*   NORD      (integer) Order of the map G (at most 4).                *
*   G(*)      Static resonance basis coefficients.                     *
* Output:                                                              *
*   F(*)      Cartesian basis coefficients.                            *
*----------------------------------------------------------------------*
      integer mcfil,mcnam,mcrng,mcstr,mcwrd,mreal,mwflt,mwnam,
     +mbbparam
*---- Double precision version.
      parameter         (mwflt = 2, mcwrd = 4, mreal = 4)
      parameter         (mcnam = 16, mwnam = mcnam / mcwrd)
      parameter         (mcfil = 80, mcrng = 40, mcstr = 512)
      parameter         (mbbparam = 26)
      integer mttact
      parameter (mttact = 100)
      integer nord
      double precision f,g
      dimension         f(*), g(*)
 
      f(1) = g(2)
      f(2) = g(3)
      f(3) = g(4)
      f(4) = g(5)
      f(5) = g(6)
      f(6) = g(1)
      if (nord .ge. 2) then
        f(7) = g(14)+g(7)
        f(8) = 2.0*g(15)
        f(9) = g(20)+g(18)
        f(10) = -g(21)+g(19)
        f(11) = g(22)
        f(12) = g(10)
        f(13) = -g(14)+g(7)
        f(14) = g(21)+g(19)
        f(15) = g(20)-g(18)
        f(16) = g(23)
        f(17) = g(11)
        f(18) = g(16)+g(8)
        f(19) = 2.0*g(17)
        f(20) = g(24)
        f(21) = g(12)
        f(22) = -g(16)+g(8)
        f(23) = g(25)
        f(24) = g(13)
        f(25) = g(26)
        f(26) = g(27)
        f(27) = g(9)
        if (nord .ge. 3) then
          f(28) = g(51)+g(43)
          f(29) = 3.0*g(52)+g(44)
          f(30) = g(59)+g(55)+g(49)
          f(31) = -g(60)+g(56)+g(50)
          f(32) = g(63)
          f(33) = g(35)+g(28)
          f(34) = -3.0*g(51)+g(43)
          f(35) = 2.0*(g(60)+g(56))
          f(36) = 2.0*(g(59)-g(55))
          f(37) = g(64)
          f(38) = 2.0*g(36)
          f(39) = g(61)+g(57)+g(47)
          f(40) = 2.0*(g(62)+g(58))
          f(41) = g(65)
          f(42) = g(41)+g(39)
          f(43) = -g(61)-g(57)+g(47)
          f(44) = g(66)
          f(45) = -g(42)+g(40)
          f(46) = g(67)
          f(47) = g(68)
          f(48) = g(31)
          f(49) = -g(52)+g(44)
          f(50) = -g(59)-g(55)+g(49)
          f(51) = g(60)-g(56)+g(50)
          f(52) = g(69)
          f(53) = -g(35)+g(28)
          f(54) = -g(62)+g(58)+g(48)
          f(55) = 2.0*(g(61)-g(57))
          f(56) = g(70)
          f(57) = g(42)+g(40)
          f(58) = g(62)-g(58)+g(48)
          f(59) = g(71)
          f(60) = g(41)-g(39)
          f(61) = g(72)
          f(62) = g(73)
          f(63) = g(32)
          f(64) = g(53)+g(45)
          f(65) = 3.0*g(54)+g(46)
          f(66) = g(74)
          f(67) = g(37)+g(29)
          f(68) = -3.0*g(53)+g(45)
          f(69) = g(75)
          f(70) = 2.0*g(38)
          f(71) = g(76)
          f(72) = g(77)
          f(73) = g(33)
          f(74) = -g(54)+g(46)
          f(75) = g(78)
          f(76) = -g(37)+g(29)
          f(77) = g(79)
          f(78) = g(80)
          f(79) = g(34)
          f(80) = g(81)
          f(81) = g(82)
          f(82) = g(83)
          f(83) = g(30)
          if (nord .ge. 4) then
            f(84) = g(138)+g(122)+g(87)
            f(85) = 2.0*g(123)+4.0*g(139)
            f(86) = g(146)+g(142)+g(134)+g(130)
            f(87) = -g(147)+g(143)-g(135)+g(131)
            f(88) = g(154)
            f(89) = g(110)+g(102)
            f(90) = 2.0*g(87)-6.0*g(138)
            f(91) = 3.0*(g(147)+g(143))+g(135)+g(131)
            f(92) = 3.0*(g(146)-g(142))+g(134)-g(130)
            f(93) = g(155)
            f(94) = 3.0*g(111)+g(103)
            f(95) = g(152)+g(150)+g(128)+g(126)+g(89)
            f(96) = 2.0*(-g(153)+g(151)+g(129))
            f(97) = g(156)
            f(98) = g(118)+g(114)+g(108)
            f(99) = -g(152)-g(150)-g(128)+g(126)+g(89)
            f(100) = g(157)
            f(101) = -g(119)+g(115)+g(109)
            f(102) = g(158)
            f(103) = g(159)
            f(104) = g(94)+g(84)
            f(105) = 2.0*g(123)-4.0*g(139)
            f(106) = -3.0*(g(146)+g(142))+g(134)+g(130)
            f(107) = 3.0*(g(147)-g(143))-g(135)+g(131)
            f(108) = g(160)
            f(109) = -3.0*g(110)+g(102)
            f(110) = 2.0*(g(153)+g(151)+g(127))
            f(111) = 4.0*(g(152)-g(150))
            f(112) = g(161)
            f(113) = 2.0*(g(119)+g(115))
            f(114) = 2.0*(-g(153)-g(151)+g(127))
            f(115) = g(162)
            f(116) = 2.0*(g(118)-g(114))
            f(117) = g(163)
            f(118) = g(164)
            f(119) = 2.0*g(95)
            f(120) = g(148)+g(144)+g(136)+g(132)
            f(121) = 3.0*(g(149)+g(145))+g(137)+g(133)
            f(122) = g(165)
            f(123) = g(120)+g(116)+g(106)
            f(124) = -3.0*(g(148)+g(144))+g(136)+g(132)
            f(125) = g(166)
            f(126) = 2.0*(g(121)+g(117))
            f(127) = g(167)
            f(128) = g(168)
            f(129) = g(100)+g(98)
            f(130) = -g(149)-g(145)+g(137)+g(133)
            f(131) = g(169)
            f(132) = -g(120)-g(116)+g(106)
            f(133) = g(170)
            f(134) = g(171)
            f(135) = -g(101)+g(99)
            f(136) = g(172)
            f(137) = g(173)
            f(138) = g(174)
            f(139) = g(90)
            f(140) = g(138)-g(122)+g(87)
            f(141) = -g(147)-g(143)+g(135)+g(131)
            f(142) = -g(146)+g(142)+g(134)-g(130)
            f(143) = g(175)
            f(144) = -g(111)+g(103)
            f(145) = -g(152)-g(150)+g(128)-g(126)+g(89)
            f(146) = 2.0*(g(153)-g(151)+g(129))
            f(147) = g(176)
            f(148) = -g(118)-g(114)+g(108)
            f(149) = g(152)+g(150)-g(128)-g(126)+g(89)
            f(150) = g(177)
            f(151) = g(119)-g(115)+g(109)
            f(152) = g(178)
            f(153) = g(179)
            f(154) = -g(94)+g(84)
            f(155) = -g(149)+g(145)-g(137)+g(133)
            f(156) = 3.0*(g(148)-g(144))+g(136)-g(132)
            f(157) = g(180)
            f(158) = -g(121)+g(117)+g(107)
            f(159) = 3.0*(g(149)-g(145))-g(137)+g(133)
            f(160) = g(181)
            f(161) = 2.0*(g(120)-g(116))
            f(162) = g(182)
            f(163) = g(183)
            f(164) = g(101)+g(99)
            f(165) = -g(148)+g(144)+g(136)-g(132)
            f(166) = g(184)
            f(167) = g(121)-g(117)+g(107)
            f(168) = g(185)
            f(169) = g(186)
            f(170) = g(100)-g(98)
            f(171) = g(187)
            f(172) = g(188)
            f(173) = g(189)
            f(174) = g(91)
            f(175) = g(140)+g(124)+g(88)
            f(176) = 2.0*g(125)+4.0*g(141)
            f(177) = g(190)
            f(178) = g(112)+g(104)
            f(179) = 2.0*g(88)-6.0*g(140)
            f(180) = g(191)
            f(181) = 3.0*g(113)+g(105)
            f(182) = g(192)
            f(183) = g(193)
            f(184) = g(96)+g(85)
            f(185) = 2.0*g(125)-4.0*g(141)
            f(186) = g(194)
            f(187) = -3.0*g(112)+g(104)
            f(188) = g(195)
            f(189) = g(196)
            f(190) = 2.0*g(97)
            f(191) = g(197)
            f(192) = g(198)
            f(193) = g(199)
            f(194) = g(92)
            f(195) = g(140)-g(124)+g(88)
            f(196) = g(200)
            f(197) = -g(113)+g(105)
            f(198) = g(201)
            f(199) = g(202)
            f(200) = -g(96)+g(85)
            f(201) = g(203)
            f(202) = g(204)
            f(203) = g(205)
            f(204) = g(93)
            f(205) = g(206)
            f(206) = g(207)
            f(207) = g(208)
            f(208) = g(209)
            f(209) = g(86)
          endif
        endif
      endif
 
      end
