      subroutine ladc2r(nord, f, g)
      implicit none
*----------------------------------------------------------------------*
* Purpose:                                                             *
*   Transform from a Cartesian basis to a dynamic resonance basis.     *
* Source:     MARYLIE, version 3.0 (routine CTODR).                    *
* Author:     Filippo Neri, June 1986.                                 *
* Input:                                                               *
*   NORD      (integer) Order of the map F (at most 4).                *
*   F(*)      Cartesian basis coefficients.                            *
* Output:                                                              *
*   G(*)      Dynamic resonance basis coefficients.                    *
*----------------------------------------------------------------------*
      integer mcfil,mcnam,mcrng,mcstr,mcwrd,mreal,mwflt,mwnam,
     +mbbparam
*---- Double precision version.
      parameter         (mwflt = 2, mcwrd = 4, mreal = 4)
      parameter         (mcnam = 16, mwnam = mcnam / mcwrd)
      parameter         (mcfil = 80, mcrng = 40, mcstr = 512)
      parameter         (mbbparam = 26)
      integer mttact
      parameter (mttact = 100)
      integer nord
      double precision by2,by4,by8,f,g
      dimension         f(*), g(*)
 
      parameter         (by2 = 1.0d0 / 2.0d0)
      parameter         (by4 = 1.0d0 / 4.0d0)
      parameter         (by8 = 1.0d0 / 8.0d0)
 
      g(1) = f(1)
      g(2) = f(2)
      g(3) = f(3)
      g(4) = f(4)
      g(5) = f(5)
      g(6) = f(6)
      if (nord .ge. 2) then
        g(7) = by2 * (f(13)+f(7))
        g(8) = by2 * (f(22)+f(18))
        g(9) = by2 * (f(27)+f(25))
        g(10) = by2 * (-f(27)+f(25))
        g(11) = by2 * f(26)
        g(12) = by2 * (-f(17)+f(11))
        g(13) = by2 * (f(16)+f(12))
        g(14) = by2 * (f(17)+f(11))
        g(15) = by2 * (f(16)-f(12))
        g(16) = by2 * (-f(24)+f(20))
        g(17) = by2 * (f(23)+f(21))
        g(18) = by2 * (f(24)+f(20))
        g(19) = by2 * (f(23)-f(21))
        g(20) = by2 * (-f(13)+f(7))
        g(21) = by2 * f(8)
        g(22) = by2 * (-f(22)+f(18))
        g(23) = by2 * f(19)
        g(24) = by2 * (-f(15)+f(9))
        g(25) = by2 * (f(14)+f(10))
        g(26) = by2 * (f(15)+f(9))
        g(27) = by2 * (f(14)-f(10))
        if (nord .ge. 3) then
          g(28) = by2 * (f(52)+f(32))
          g(29) = by2 * (f(53)+f(33))
          g(30) = by2 * (f(75)+f(66))
          g(31) = by2 * (f(76)+f(67))
          g(32) = by4 * (-f(82)+f(80))
          g(33) = by4 * (-f(83)+f(81))
          g(34) = by4 * (f(82) + 3.0*f(80))
          g(35) = by4 * (f(81) + 3.0*f(83))
          g(36) = by2 * (f(48)+f(46))
          g(37) = by2 * (f(63)+f(61))
          g(38) = by2 * (f(73)+f(71))
          g(39) = by2 * (f(79)+f(77))
          g(40) = by4 * (-f(62)-f(48)+f(46))
          g(41) = by4 * (-f(63)+f(61)+f(47))
          g(42) = by4 * (f(62)-f(48)+f(46))
          g(43) = by4 * (-f(63)+f(61)-f(47))
          g(44) = by4 * (-f(78)-f(73)+f(71))
          g(45) = by4 * (-f(79)+f(77)+f(72))
          g(46) = by4 * (f(78)-f(73)+f(71))
          g(47) = by4 * (-f(79)+f(77)-f(72))
          g(48) = by4 * (-f(52)-f(38)+f(32))
          g(49) = by4 * (-f(53)+f(37)+f(33))
          g(50) = by4 * (-f(52)+f(38)+f(32))
          g(51) = by4 * (f(53)+f(37)-f(33))
          g(52) = by4 * (-f(75)-f(70)+f(66))
          g(53) = by4 * (-f(76)+f(69)+f(67))
          g(54) = by4 * (-f(75)+f(70)+f(66))
          g(55) = by4 * (f(76)+f(69)-f(67))
          g(56) = by4 * (-f(59)-f(57)-f(45)+f(41))
          g(57) = by4 * (-f(60)+f(56)+f(44)+f(42))
          g(58) = by4 * (-f(59)+f(57)+f(45)+f(41))
          g(59) = by4 * (f(60)+f(56)+f(44)-f(42))
          g(60) = by4 * (f(59)-f(57)+f(45)+f(41))
          g(61) = by4 * (f(60)+f(56)-f(44)+f(42))
          g(62) = by4 * (f(59)+f(57)-f(45)+f(41))
          g(63) = by4 * (-f(60)+f(56)-f(44)-f(42))
          g(64) = by4 * (f(34) + 3.0*f(28))
          g(65) = by4 * (f(29) + 3.0*f(49))
          g(66) = by4 * (f(68) + 3.0*f(64))
          g(67) = by4 * (f(65) + 3.0*f(74))
          g(68) = by2 * (f(43)+f(39))
          g(69) = by2 * (f(58)+f(54))
          g(70) = by2 * (f(50)+f(30))
          g(71) = by2 * (f(51)+f(31))
          g(72) = by4 * (-f(34)+f(28))
          g(73) = by4 * (-f(49)+f(29))
          g(74) = by4 * (-f(68)+f(64))
          g(75) = by4 * (-f(74)+f(65))
          g(76) = by4 * (-f(50)-f(36)+f(30))
          g(77) = by4 * (-f(51)+f(35)+f(31))
          g(78) = by4 * (-f(55)-f(43)+f(39))
          g(79) = by4 * (-f(58)+f(54)+f(40))
          g(80) = by4 * (-f(50)+f(36)+f(30))
          g(81) = by4 * (f(51)+f(35)-f(31))
          g(82) = by4 * (f(55)-f(43)+f(39))
          g(83) = by4 * (-f(58)+f(54)-f(40))
          if (nord .ge. 4) then
            g(84) = by8 * (f(90) + 3.0*(f(140)+f(84)))
            g(85) = by8 * (f(179) + 3.0*(f(195)+f(175)))
            g(86) = by8 * (f(207) + 3.0*(f(209)+f(205)))
            g(87) = by4 * (f(149)+f(145)+f(99)+f(95))
            g(88) = by4 * (f(154)+f(152)+f(104)+f(102))
            g(89) = by4 * (f(200)+f(198)+f(184)+f(182))
            g(90) = by4 * (-f(154)+f(152)-f(104)+f(102))
            g(91) = by4 * (f(153)+f(103))
            g(92) = by4 * (-f(200)+f(198)-f(184)+f(182))
            g(93) = by4 * (f(199)+f(183))
            g(94) = by8 * (f(209)-f(207)+f(205))
            g(95) = by8 * (-f(208)+f(206))
            g(96) = by2 * (-f(209)+f(205))
            g(97) = by4 * (f(208)+f(206))
            g(98) = by8 * (f(174)-f(172)-f(138)+f(136))
            g(99) = by8 * (-f(173)+f(171)-f(139)+f(137))
            g(100) = by8 * (-f(174)+f(172)-f(138)+f(136))
            g(101) = by8 * (-f(173)+f(171)+f(139)-f(137))
            g(102) = by8 * (f(204)-f(202)-f(193)+f(191))
            g(103) = by8 * (-f(203)+f(201)-f(194)+f(192))
            g(104) = by8 * (-f(204)+f(202)-f(193)+f(191))
            g(105) = by8 * (-f(203)+f(201)+f(194)-f(192))
            g(106) = by8 * ((-f(172)+f(138)) + 3.0*(-f(174)+f(136)))
            g(107) = by8 * ((f(173)+f(137)) + 3.0*(f(171)+f(139)))
            g(108) = by8 * ((f(172)+f(138)) + 3.0*(f(174)+f(136)))
            g(109) = by8 * ((f(173)-f(137)) + 3.0*(f(171)-f(139)))
            g(110) = by8 * ((-f(202)+f(193)) + 3.0*(-f(204)+f(191)))
            g(111) = by8 * ((f(203)+f(192)) + 3.0*(f(201)+f(194)))
            g(112) = by8 * ((f(202)+f(193)) + 3.0*(f(204)+f(191)))
            g(113) = by8 * ((f(203)-f(192)) + 3.0*(f(201)-f(194)))
            g(114) = by4 * (-f(154)-f(152)+f(104)+f(102))
            g(115) = by4 * (f(119)+f(117))
            g(116) = by4 * (-f(200)-f(198)+f(184)+f(182))
            g(117) = by4 * (f(190)+f(188))
            g(118) = by8 * (f(154)-f(152)-f(118)-f(104)+f(102))
            g(119) = by8 * (-f(153)-f(119)+f(117)+f(103))
            g(120) = by8 * (f(154)-f(152)+f(118)-f(104)+f(102))
            g(121) = by8 * (f(153)-f(119)+f(117)-f(103))
            g(122) = by8 * (f(200)-f(198)-f(189)-f(184)+f(182))
            g(123) = by8 * (-f(199)-f(190)+f(188)+f(183))
            g(124) = by8 * (f(200)-f(198)+f(189)-f(184)+f(182))
            g(125) = by8 * (f(199)-f(190)+f(188)-f(183))
            g(126) = by4 * (-f(170)-f(168)+f(129)+f(127))
            g(127) = by4 * (f(164)+f(162)+f(135)+f(133))
            g(128) = by4 * (f(170)+f(168)+f(129)+f(127))
            g(129) = by4 * (f(164)+f(162)-f(135)-f(133))
            g(130) = by8 * (f(170)-f(168)-f(163)-f(134)-f(129)+f(127))
            g(131) = by8 * (-f(169)-f(164)+f(162)-f(135)+f(133)+f(128))
            g(132) = by8 * (f(170)-f(168)+f(163)+f(134)-f(129)+f(127))
            g(133) = by8 * (f(169)-f(164)+f(162)-f(135)+f(133)-f(128))
            g(134) = by8 * (-f(170)+f(168)-f(163)+f(134)-f(129)+f(127))
            g(135) = by8 * (f(169)-f(164)+f(162)+f(135)-f(133)+f(128))
            g(136) = by8 * (-f(170)+f(168)+f(163)-f(134)-f(129)+f(127))
            g(137) = by8 * (-f(169)-f(164)+f(162)+f(135)-f(133)-f(128))
            g(138) = by8 * ((f(108)-f(94)) + 3.0*(-f(144)+f(88)))
            g(139) = by8 * ((f(109)+f(93)) + 3.0*(f(143)+f(89)))
            g(140) = by8 * ((f(108)+f(94)) + 3.0*(f(144)+f(88)))
            g(141) = by8 * ((-f(109)+f(93)) + 3.0*(f(143)-f(89)))
            g(142) = by8 * ((f(186)-f(181)) + 3.0*(-f(197)+f(177)))
            g(143) = by8 * ((f(187)+f(180)) + 3.0*(f(196)+f(178)))
            g(144) = by8 * ((f(186)+f(181)) + 3.0*(f(197)+f(177)))
            g(145) = by8 * ((-f(187)+f(180)) + 3.0*(f(196)-f(178)))
            g(146) = by4 * (-f(167)-f(158)+f(131)+f(122))
            g(147) = by4 * (f(166)+f(157)+f(132)+f(123))
            g(148) = by4 * (f(167)+f(158)+f(131)+f(122))
            g(149) = by4 * (f(166)+f(157)-f(132)-f(123))
            g(150) = by4 * (-f(151)+f(147)-f(101)+f(97))
            g(151) = by4 * (f(150)+f(148)+f(100)+f(98))
            g(152) = by4 * (f(151)+f(147)+f(101)+f(97))
            g(153) = by4 * (f(150)-f(148)+f(100)-f(98))
            g(154) = by8 * (f(144)-f(108)-f(94)+f(88))
            g(155) = by8 * (-f(143)-f(109)+f(93)+f(89))
            g(156) = by8 * (-f(144)-f(108)+f(94)+f(88))
            g(157) = by8 * (-f(143)+f(109)+f(93)-f(89))
            g(158) = by8 * (f(197)-f(186)-f(181)+f(177))
            g(159) = by8 * (-f(196)-f(187)+f(180)+f(178))
            g(160) = by8 * (-f(197)-f(186)+f(181)+f(177))
            g(161) = by8 * (-f(196)+f(187)+f(180)-f(178))
            g(162) = by8 * (f(151)-f(147)-f(115)-f(113)-f(101)+f(97))
            g(163) = by8 * (-f(150)-f(148)-f(116)+f(112)+f(100)+f(98))
            g(164) = by8 * (-f(151)-f(147)-f(115)+f(113)+f(101)+f(97))
            g(165) = by8 * (-f(150)+f(148)+f(116)+f(112)+f(100)-f(98))
            g(166) = by8 * (f(167)-f(160)-f(158)-f(131)-f(126)+f(122))
            g(167) = by8 * (-f(166)-f(161)+f(157)-f(132)+f(125)+f(123))
            g(168) = by8 * (-f(167)-f(160)+f(158)-f(131)+f(126)+f(122))
            g(169) = by8 * (-f(166)+f(161)+f(157)+f(132)+f(125)-f(123))
            g(170) = by8 * (-f(151)-f(147)+f(115)-f(113)+f(101)+f(97))
            g(171) = by8 * (f(150)-f(148)+f(116)+f(112)-f(100)+f(98))
            g(172) = by8 * (f(151)-f(147)+f(115)+f(113)-f(101)+f(97))
            g(173) = by8 * (f(150)+f(148)-f(116)+f(112)-f(100)-f(98))
            g(174) = by8 * (-f(167)+f(160)+f(158)-f(131)-f(126)+f(122))
            g(175) = by8 * (-f(166)-f(161)+f(157)+f(132)-f(125)-f(123))
            g(176) = by8 * (f(167)+f(160)-f(158)-f(131)+f(126)+f(122))
            g(177) = by8 * (-f(166)+f(161)+f(157)-f(132)-f(125)+f(123))
            g(178) = by2 * (-f(140)+f(84))
            g(179) = by4 * (f(105)+f(85))
            g(180) = by2 * (-f(195)+f(175))
            g(181) = by4 * (f(185)+f(176))
            g(182) = by4 * (-f(149)-f(145)+f(99)+f(95))
            g(183) = by4 * (f(114)+f(110))
            g(184) = by4 * (-f(149)+f(145)-f(99)+f(95))
            g(185) = by4 * (f(146)+f(96))
            g(186) = by8 * ((f(106)-f(92)) + 3.0*(-f(142)+f(86)))
            g(187) = by8 * ((f(107)+f(91)) + 3.0*(f(141)+f(87)))
            g(188) = by8 * ((-f(156)+f(124)) + 3.0*(-f(165)+f(120)))
            g(189) = by8 * ((f(159)+f(121)) + 3.0*(f(155)+f(130)))
            g(190) = by8 * ((f(106)+f(92)) + 3.0*(f(142)+f(86)))
            g(191) = by8 * ((-f(107)+f(91)) + 3.0*(f(141)-f(87)))
            g(192) = by8 * ((f(156)+f(124)) + 3.0*(f(165)+f(120)))
            g(193) = by8 * ((f(159)-f(121)) + 3.0*(f(155)-f(130)))
            g(194) = by8 * (f(140)-f(90)+f(84))
            g(195) = by8 * (-f(105)+f(85))
            g(196) = by8 * (f(195)-f(179)+f(175))
            g(197) = by8 * (-f(185)+f(176))
            g(198) = by8 * (f(142)-f(106)-f(92)+f(86))
            g(199) = by8 * (-f(141)-f(107)+f(91)+f(87))
            g(200) = by8 * (f(165)-f(156)-f(124)+f(120))
            g(201) = by8 * (-f(159)+f(155)-f(130)+f(121))
            g(202) = by8 * (-f(142)-f(106)+f(92)+f(86))
            g(203) = by8 * (-f(141)+f(107)+f(91)-f(87))
            g(204) = by8 * (-f(165)+f(156)-f(124)+f(120))
            g(205) = by8 * (-f(159)+f(155)+f(130)-f(121))
            g(206) = by8 * (f(149)-f(145)-f(111)-f(99)+f(95))
            g(207) = by8 * (-f(146)-f(114)+f(110)+f(96))
            g(208) = by8 * (f(149)-f(145)+f(111)-f(99)+f(95))
            g(209) = by8 * (f(146)-f(114)+f(110)-f(96))
          endif
        endif
      endif
 
      end
